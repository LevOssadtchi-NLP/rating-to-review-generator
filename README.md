## Тонкая настройка GPT-2 для генерации отзывов о фильмах

---

### Обзор проекта

Этот проект представляет собой Jupyter-ноутбук, который демонстрирует тонкую настройку модели **GPT-2** для генерации текста с заданным настроением. В качестве датасета используется **Large Movie Review Dataset v1.0**, содержащий 50 000 отзывов о фильмах.

Цель проекта — обучить модель генерировать новые отзывы о фильмах, которые соответствуют определённому рейтингу от 1 до 8 (эта шкала выбрана в соответствии со спецификой датасета). Модель учится связывать заданный рейтинг с соответствующей тональностью отзыва.

---

### Используемый датасет

Данные для проекта были взяты с [Large Movie Review Dataset (IMDB)](https://ai.stanford.edu/~amaas/data/sentiment/).

---

### Структура и запуск

Репозиторий содержит единственный файл `GPT2_finetuning.ipynb`, который включает в себя все шаги:

1.  **Загрузка данных:** Ноутбук загружает данные из указанного источника.
2.  **Подготовка данных:** Отзывы и их рейтинги обрабатываются для подготовки к обучению.
3.  **Обучение модели:** Модель GPT-2 тонко настраивается с использованием библиотеки **Transformers**.
4.  **Оценка:** Производится оценка качества сгенерированных отзывов.

### Оценка
Для оценки качества сгенерированных отзывов используется отдельная, заранее обученная модель **sentiment analysis**. Она оценивает настроение (рейтинг) каждого сгенерированного отзыва. Затем вычисляется **среднее абсолютное отклонение (MAE)** между реальным рейтингом, который был задан при генерации, и рейтингом, который был оценен с помощью модели sentiment analysis. Эта метрика показывает, насколько точно модель GPT-2 научилась генерировать отзывы с заданной тональностью.

Для запуска проекта необходимо открыть файл `GPT2_finetuning.ipynb` в среде, поддерживающей Jupyter Notebook, например, Google Colab.

---

### Результаты

В результате выполнения ноутбука модель успешно тонко настраивается. Ноутбук содержит таблицу с показателями **Training Loss** на различных этапах обучения, а также результаты вычисления MAE для сгенерированных отзывов с разными рейтингами. Дообученую модель можно найти на HF по ссылке https://huggingface.co/levos06/gpt2-large-finetuned.

## Попробуйте сами!

1. Склонируйте репозиторий:

   ```bash
   git clone https://github.com/LevOssadtchi-NLP/rating-to-review-generator.git
   cd rating-to-review-generator
   ```
2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```
3. Запустите Streamlit-приложение:

   ```bash
   streamlit run app.py
   ```
4. В приложении выберите рейтинг, количество отзывов, нажмите кнопку — и получите готовые сгенерированные отзывы.

